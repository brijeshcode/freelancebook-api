import{A as e,B as t,C as n,D as r,G as i,I as a,J as o,K as ee,N as s,O as c,P as l,Q as u,R as d,S as f,U as p,f as m,j as te,l as ne,m as re,r as h,s as g,t as ie,u as _,v as ae,w as v,x as oe,y,z as b}from"./index-Bi8CIbZL.js";import{b as x}from"./createLucideIcon-DepPGo-R.js";import{b as se}from"./arrow-left-CKqWvwl9.js";import{b as ce}from"./info-CdFcQMFd.js";import{b as le}from"./loader-circle-D6LExQqK.js";import{b as ue}from"./x-CDOVyvn4.js";const de=x(`paperclip`,[[`path`,{d:`m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551`,key:`1miecu`}]]),S=x(`upload`,[[`path`,{d:`M12 3v12`,key:`1x0j5s`}],[`path`,{d:`m17 8-5-5-5 5`,key:`7q97r8`}],[`path`,{d:`M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4`,key:`ih7n3h`}]]),fe={class:`space-y-6`},pe={class:`flex flex-col sm:flex-row sm:items-center sm:justify-between`},me={class:`mt-4 sm:mt-0`},C={key:0,class:`bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4`},w={class:`flex items-center`},T={class:`flex-1`},E={class:`mt-1 flex items-center space-x-4`},D={class:`text-sm text-blue-700 dark:text-blue-300`},O={class:`font-semibold`},k={class:`text-sm text-blue-700 dark:text-blue-300`},A={class:`text-sm text-blue-700 dark:text-blue-300`},j={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},M={class:`px-4 py-5 sm:p-6`},N={class:`grid grid-cols-1 md:grid-cols-2 gap-6`},P=[`value`],F={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},I={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},L={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},R={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},z=[`max`],he={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},ge={key:0,class:`mt-1 text-sm text-red-600 dark:text-red-400`},_e={class:`md:col-span-2`},ve={class:`px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white sm:text-sm`},ye={class:`mt-6`},be={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},xe={class:`px-4 py-5 sm:p-6`},Se={class:`space-y-4`},Ce={class:`border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center hover:border-gray-400 dark:hover:border-gray-500 transition-colors duration-200`},we={class:`mt-4`},Te={key:0,class:`space-y-2`},Ee={class:`space-y-2`},De={class:`flex items-center`},Oe={class:`text-sm font-medium text-gray-900 dark:text-white`},B={class:`text-xs text-gray-500 dark:text-gray-400`},ke=[`onClick`],Ae={class:`bg-white dark:bg-gray-800 shadow rounded-lg`},je={class:`px-4 py-5 sm:p-6`},Me={class:`space-y-3`},Ne={class:`flex justify-between`},Pe={class:`text-sm font-medium text-gray-900 dark:text-white`},Fe={key:0,class:`flex justify-between`},Ie={class:`text-sm font-medium text-gray-900 dark:text-white`},Le={class:`border-t border-gray-200 dark:border-gray-700 pt-3`},Re={class:`flex justify-between`},ze={class:`text-base font-medium text-gray-900 dark:text-white`},Be={key:1,class:`border-t border-gray-200 dark:border-gray-700 pt-3`},Ve={class:`flex justify-between`},He={class:`text-sm font-medium text-gray-900 dark:text-white`},Ue={class:`flex flex-col sm:flex-row gap-3 sm:justify-end`},We=[`disabled`];var V=r({__name:`Create`,setup(r){let x=re(),V=ne(),H=te(),U=u(!1),W=u([]),G=u(null),K=u({}),q=u([]),Ge=u(),J=new Date().toISOString().split(`T`)[0],Y=l({client_id:``,amount:0,currency:`USD`,exchange_rate:1,payment_date:J,payment_method:``,transaction_reference:``,notes:``,status:`completed`,receipt_attachments:[]}),X=ae(()=>(Y.amount||0)*Y.exchange_rate),Ke=async()=>{try{let e=await m.get(`/clients`);W.value=e.data.data}catch{H.error(`Failed to load clients`,{title:`Error`})}},Z=async()=>{G.value=null,Y.client_id&&await qe()},qe=async()=>{try{let e=await m.get(`/clients/${Y.client_id}/balance`);G.value=e.data.data}catch(e){console.error(`Failed to load client balance:`,e)}},Q=()=>{},Je=e=>{let t=e.target,n=t.files;if(n)for(let e=0;e<n.length;e++){let t=n[e];if(t.size>10*1024*1024){H.error(`File ${t.name} is too large. Maximum size is 10MB.`,{title:`File Upload Error`});continue}let r=[`image/jpeg`,`image/jpg`,`image/png`,`image/gif`,`application/pdf`];if(!r.includes(t.type)){H.error(`File ${t.name} is not a supported format.`,{title:`File Upload Error`});continue}q.value.push(t)}t&&(t.value=``)},Ye=e=>{q.value.splice(e,1)},Xe=e=>{if(e===0)return`0 Bytes`;let t=1024,n=[`Bytes`,`KB`,`MB`,`GB`],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/t**+r).toFixed(2))+` `+n[r]},$=e=>e.toLocaleString(`en-US`,{minimumFractionDigits:2,maximumFractionDigits:2}),Ze=async()=>{if(q.value.length===0)return[];let e=new FormData;q.value.forEach((t,n)=>{e.append(`files[${n}]`,t)});try{let t=await m.post(`/payments/upload-receipts`,e,{headers:{"Content-Type":`multipart/form-data`}});return t.data.file_paths||[]}catch{return H.error(`Failed to upload receipt files`,{title:`Upload Error`}),[]}},Qe=async()=>{U.value=!0,K.value={};try{q.value.length>0&&(Y.receipt_attachments=await Ze());let e=await m.post(`/payments`,Y);H.success(`Payment recorded successfully`,{title:`Success`}),x.push(`/payments/${e.data.data.id}`)}catch(e){e.response?.status===422?(K.value=e.response.data.errors||{},H.error(`Please check the form for errors`,{title:`Validation Error`})):H.error(`Failed to record payment`,{title:`Error`})}finally{U.value=!1}};return i(async()=>{await Ke();let e=V.query.client_id;e&&(Y.client_id=e,await Z())}),(r,i)=>{let l=ee(`router-link`);return a(),b(`div`,fe,[v(`div`,pe,[i[11]||=v(`div`,null,[v(`h1`,{class:`text-2xl font-bold text-gray-900 dark:text-white`},`Record Payment`),v(`p`,{class:`mt-1 text-sm text-gray-500 dark:text-gray-400`},` Record a new payment from your client `)],-1),v(`div`,me,[n(l,{to:`/payments`,class:`inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-900 transition-colors duration-200`},{default:s(()=>[n(d(se),{class:`h-5 w-5 mr-2`}),i[10]||=t(` Back to Payments `,-1)]),_:1,__:[10]})])]),Y.client_id&&G.value?(a(),b(`div`,C,[v(`div`,w,[n(d(ce),{class:`h-5 w-5 text-blue-400 mr-3`}),v(`div`,T,[i[13]||=v(`h3`,{class:`text-sm font-medium text-blue-800 dark:text-blue-200`},` Client Outstanding Balance `,-1),v(`div`,E,[v(`span`,D,[i[12]||=t(` Current Balance: `,-1),v(`span`,O,p($(G.value.outstanding_balance)),1)]),v(`span`,k,` Total Invoiced: `+p($(G.value.total_invoiced)),1),v(`span`,A,` Total Paid: `+p($(G.value.total_paid)),1)])])])])):y(``,!0),v(`form`,{onSubmit:ie(Qe,[`prevent`]),class:`space-y-6`},[v(`div`,j,[v(`div`,M,[i[32]||=v(`h3`,{class:`text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4`},` Payment Details `,-1),v(`div`,N,[v(`div`,null,[i[15]||=v(`label`,{for:`client_id`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[t(` Client `),v(`span`,{class:`text-red-500`},`*`)],-1),c(v(`select`,{id:`client_id`,"onUpdate:modelValue":i[0]||=e=>Y.client_id=e,class:f([`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,K.value.client_id?`border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500`:`border-gray-300 dark:border-gray-600`]),onChange:Z},[i[14]||=v(`option`,{value:``},`Select a client`,-1),(a(!0),b(_,null,o(W.value,e=>(a(),b(`option`,{key:e.id,value:e.id},p(e.name),9,P))),128))],34),[[h,Y.client_id]]),K.value.client_id?(a(),b(`p`,F,p(K.value.client_id[0]),1)):y(``,!0)]),v(`div`,null,[i[16]||=v(`label`,{for:`amount`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[t(` Payment Amount `),v(`span`,{class:`text-red-500`},`*`)],-1),c(v(`input`,{id:`amount`,"onUpdate:modelValue":i[1]||=e=>Y.amount=e,type:`number`,step:`0.01`,min:`0.01`,class:f([`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,K.value.amount?`border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500`:`border-gray-300 dark:border-gray-600`]),placeholder:`0.00`,onInput:Q},null,34),[[g,Y.amount]]),K.value.amount?(a(),b(`p`,I,p(K.value.amount[0]),1)):y(``,!0)]),v(`div`,null,[i[18]||=v(`label`,{for:`currency`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[t(` Currency `),v(`span`,{class:`text-red-500`},`*`)],-1),c(v(`select`,{id:`currency`,"onUpdate:modelValue":i[2]||=e=>Y.currency=e,class:f([`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,K.value.currency?`border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500`:`border-gray-300 dark:border-gray-600`]),onChange:Q},i[17]||=[e(`<option value="">Select currency</option><option value="USD">USD - US Dollar</option><option value="EUR">EUR - Euro</option><option value="GBP">GBP - British Pound</option><option value="INR">INR - Indian Rupee</option><option value="CAD">CAD - Canadian Dollar</option><option value="AUD">AUD - Australian Dollar</option>`,7)],34),[[h,Y.currency]]),K.value.currency?(a(),b(`p`,L,p(K.value.currency[0]),1)):y(``,!0)]),v(`div`,null,[i[19]||=v(`label`,{for:`exchange_rate`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[t(` Exchange Rate `),v(`span`,{class:`text-red-500`},`*`)],-1),c(v(`input`,{id:`exchange_rate`,"onUpdate:modelValue":i[3]||=e=>Y.exchange_rate=e,type:`number`,step:`0.000001`,min:`0.000001`,max:`9999.999999`,class:f([`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,K.value.exchange_rate?`border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500`:`border-gray-300 dark:border-gray-600`]),placeholder:`1.000000`,onInput:Q},null,34),[[g,Y.exchange_rate]]),i[20]||=v(`p`,{class:`mt-1 text-xs text-gray-500 dark:text-gray-400`},` Rate to convert to your base currency `,-1),K.value.exchange_rate?(a(),b(`p`,R,p(K.value.exchange_rate[0]),1)):y(``,!0)]),v(`div`,null,[i[21]||=v(`label`,{for:`payment_date`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[t(` Payment Date `),v(`span`,{class:`text-red-500`},`*`)],-1),c(v(`input`,{id:`payment_date`,"onUpdate:modelValue":i[4]||=e=>Y.payment_date=e,type:`date`,max:d(J),class:f([`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,K.value.payment_date?`border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500`:`border-gray-300 dark:border-gray-600`])},null,10,z),[[g,Y.payment_date]]),K.value.payment_date?(a(),b(`p`,he,p(K.value.payment_date[0]),1)):y(``,!0)]),v(`div`,null,[i[23]||=v(`label`,{for:`payment_method`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},[t(` Payment Method `),v(`span`,{class:`text-red-500`},`*`)],-1),c(v(`select`,{id:`payment_method`,"onUpdate:modelValue":i[5]||=e=>Y.payment_method=e,class:f([`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,K.value.payment_method?`border-red-300 dark:border-red-600 focus:ring-red-500 focus:border-red-500`:`border-gray-300 dark:border-gray-600`])},i[22]||=[e(`<option value="">Select payment method</option><option value="bank_transfer">Bank Transfer</option><option value="paypal">PayPal</option><option value="stripe">Stripe</option><option value="western_union">Western Union</option><option value="cash">Cash</option><option value="check">Check</option><option value="crypto">Cryptocurrency</option><option value="other">Other</option>`,9)],2),[[h,Y.payment_method]]),K.value.payment_method?(a(),b(`p`,ge,p(K.value.payment_method[0]),1)):y(``,!0)]),v(`div`,_e,[i[24]||=v(`label`,{for:`transaction_reference`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Transaction Reference (Optional) `,-1),c(v(`input`,{id:`transaction_reference`,"onUpdate:modelValue":i[6]||=e=>Y.transaction_reference=e,type:`text`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,placeholder:`Bank reference, PayPal transaction ID, etc.`},null,512),[[g,Y.transaction_reference]]),i[25]||=v(`p`,{class:`mt-1 text-xs text-gray-500 dark:text-gray-400`},` Any reference number or ID associated with this payment `,-1)]),v(`div`,null,[i[27]||=v(`label`,{for:`status`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Payment Status `,-1),c(v(`select`,{id:`status`,"onUpdate:modelValue":i[7]||=e=>Y.status=e,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`},i[26]||=[v(`option`,{value:`pending`},`Pending`,-1),v(`option`,{value:`completed`},`Completed`,-1),v(`option`,{value:`failed`},`Failed`,-1)],512),[[h,Y.status]]),i[28]||=v(`p`,{class:`mt-1 text-xs text-gray-500 dark:text-gray-400`},` Set as "Completed" if payment is confirmed, "Pending" if awaiting confirmation `,-1)]),v(`div`,null,[i[29]||=v(`label`,{class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Amount in Base Currency `,-1),v(`div`,ve,p($(X.value)),1),i[30]||=v(`p`,{class:`mt-1 text-xs text-gray-500 dark:text-gray-400`},` Automatically calculated based on amount and exchange rate `,-1)])]),v(`div`,ye,[i[31]||=v(`label`,{for:`notes`,class:`block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2`},` Notes (Optional) `,-1),c(v(`textarea`,{id:`notes`,"onUpdate:modelValue":i[8]||=e=>Y.notes=e,rows:`3`,class:`block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white sm:text-sm transition-colors duration-200`,placeholder:`Additional notes about this payment...`},null,512),[[g,Y.notes]])])])]),v(`div`,be,[v(`div`,xe,[i[36]||=v(`h3`,{class:`text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4`},` Receipt Attachments (Optional) `,-1),v(`div`,Se,[v(`div`,Ce,[v(`input`,{ref_key:`fileInput`,ref:Ge,type:`file`,multiple:``,accept:`.pdf,.jpg,.jpeg,.png,.gif`,class:`hidden`,onChange:Je},null,544),n(d(S),{class:`h-12 w-12 mx-auto text-gray-400`}),v(`div`,we,[v(`button`,{type:`button`,onClick:i[9]||=e=>r.$refs.fileInput?.click(),class:`inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/40 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200`},[n(d(S),{class:`h-5 w-5 mr-2`}),i[33]||=t(` Upload Receipt Files `,-1)])]),i[34]||=v(`p`,{class:`mt-2 text-sm text-gray-500 dark:text-gray-400`},` PNG, JPG, GIF, PDF up to 10MB each `,-1)]),q.value.length>0?(a(),b(`div`,Te,[i[35]||=v(`h4`,{class:`text-sm font-medium text-gray-900 dark:text-white`},`Uploaded Files:`,-1),v(`div`,Ee,[(a(!0),b(_,null,o(q.value,(e,t)=>(a(),b(`div`,{key:t,class:`flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-900 rounded-lg`},[v(`div`,De,[n(d(de),{class:`h-5 w-5 text-gray-400 mr-3`}),v(`div`,null,[v(`div`,Oe,p(e.name),1),v(`div`,B,p(Xe(e.size)),1)])]),v(`button`,{type:`button`,onClick:e=>Ye(t),class:`text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300 transition-colors duration-200`},[n(d(ue),{class:`h-5 w-5`})],8,ke)]))),128))])])):y(``,!0)])])]),v(`div`,Ae,[v(`div`,je,[i[41]||=v(`h3`,{class:`text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4`},` Payment Summary `,-1),v(`div`,Me,[v(`div`,Ne,[i[37]||=v(`span`,{class:`text-sm text-gray-500 dark:text-gray-400`},`Payment Amount:`,-1),v(`span`,Pe,p(Y.currency)+` `+p($(Y.amount||0)),1)]),Y.exchange_rate===1?y(``,!0):(a(),b(`div`,Fe,[i[38]||=v(`span`,{class:`text-sm text-gray-500 dark:text-gray-400`},`Exchange Rate:`,-1),v(`span`,Ie,p(Y.exchange_rate),1)])),v(`div`,Le,[v(`div`,Re,[i[39]||=v(`span`,{class:`text-base font-medium text-gray-900 dark:text-white`},`Base Currency Amount:`,-1),v(`span`,ze,p($(X.value)),1)])]),G.value&&Y.status===`completed`?(a(),b(`div`,Be,[v(`div`,Ve,[i[40]||=v(`span`,{class:`text-sm text-gray-500 dark:text-gray-400`},`New Client Balance:`,-1),v(`span`,He,p($(G.value.outstanding_balance-X.value)),1)])])):y(``,!0)])])]),v(`div`,Ue,[n(l,{to:`/payments`,class:`w-full sm:w-auto inline-flex justify-center items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-900 transition-colors duration-200`},{default:s(()=>i[42]||=[t(` Cancel `,-1)]),_:1,__:[42]}),v(`button`,{type:`submit`,disabled:U.value||!Y.client_id||!Y.amount,class:`w-full sm:w-auto inline-flex justify-center items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 dark:bg-blue-700 dark:hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:focus:ring-offset-gray-900 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200`},[U.value?(a(),oe(d(le),{key:0,class:`h-4 w-4 animate-spin mr-2`})):y(``,!0),t(` `+p(U.value?`Recording...`:`Record Payment`),1)],8,We)])],32)])}}}),H=V;export{H as default};